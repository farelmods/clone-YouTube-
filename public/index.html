<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playtube</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #9d4edd;
            --primary-hover: #c77dff;
            --bg-color: #0f0f0f;
            --sidebar-bg: #0f0f0f;
            --header-bg: #0f0f0f;
            --text-color: #ffffff;
            --text-secondary: #aaaaaa;
            --border-color: #222222;
            --hover-bg: #272727;
            --active-bg: #3f3f3f;
            --card-bg: #0f0f0f;
        }

        * {
            box-sizing: border-box;
        }

        html, body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Roboto', Arial, sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            width: 100%;
        }

        /* Header */
        header {
            background-color: var(--header-bg);
            padding: 0 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 56px;
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
            transition: transform 0.3s ease-in-out;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .menu-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
        }

        .menu-btn:hover {
            background-color: var(--hover-bg);
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
            gap: 4px;
        }

        .logo span {
            color: var(--text-color);
            letter-spacing: -1px;
        }

        .header-center {
            display: flex;
            align-items: center;
            flex-grow: 1;
            justify-content: center;
            max-width: 720px;
            gap: 8px;
        }

        .search-wrapper {
            display: flex;
            width: 100%;
            max-width: 600px;
            position: relative;
        }

        .search-suggestions {
            display: none;
            position: absolute;
            top: 42px;
            left: 0;
            right: 0;
            background-color: #212121;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            z-index: 2000;
            padding: 8px;
            border: 1px solid var(--border-color);
        }

        .suggestion-item {
            display: flex;
            align-items: center;
            padding: 8px 16px;
            gap: 16px;
            cursor: pointer;
            font-size: 16px;
        }

        .suggestion-item:hover {
            background-color: var(--hover-bg);
        }

        .suggestion-item svg {
            color: var(--text-secondary);
        }

        .search-wrapper input {
            flex-grow: 1;
            padding: 0 16px;
            height: 40px;
            background-color: #121212;
            color: white;
            border: 1px solid var(--border-color);
            border-radius: 40px 0 0 40px;
            font-size: 16px;
            outline: none;
        }

        .search-wrapper input:focus {
            border-color: var(--primary-color);
        }

        .search-btn {
            width: 64px;
            height: 40px;
            background-color: #222222;
            color: white;
            border: 1px solid var(--border-color);
            border-left: none;
            border-radius: 0 40px 40px 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            border-radius: 50%;
        }

        /* Ripple Effect */
        .ripple {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: scale(0);
            animation: ripple-animation 0.6s linear;
            pointer-events: none;
        }

        @keyframes ripple-animation {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        .ripple-container {
            position: relative !important;
            overflow: hidden !important;
        }

        /* Skeleton Animation */
        .skeleton {
            background: linear-gradient(90deg, #1a1a1a 25%, #272727 50%, #1a1a1a 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-thumb {
            width: 100%;
            aspect-ratio: 16/9;
            border-radius: 12px;
            margin-bottom: 12px;
        }

        .skeleton-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .skeleton-text {
            height: 14px;
            border-radius: 4px;
            margin-bottom: 8px;
        }

        .skeleton-title { width: 80%; height: 18px; }
        .skeleton-meta { width: 60%; }

        @media (max-width: 600px) {
            .skeleton-thumb { border-radius: 0; }
        }

        .search-btn:hover {
            background-color: #f0f0f0;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .mic-btn {
            background-color: #f8f8f8;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mic-btn:hover {
            background-color: #333333;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .login-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            background: none;
            border: 1px solid var(--border-color);
            padding: 6px 12px;
            cursor: pointer;
            border-radius: 20px;
            color: var(--primary-color);
            font-weight: 500;
        }

        .login-btn:hover {
            background-color: var(--hover-bg);
            border-color: var(--primary-color);
        }

        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mobile-only {
            display: none;
        }

        .desktop-only {
            display: flex;
        }

        .signin-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 0 12px;
            height: 36px;
            border: 1px solid var(--border-color);
            border-radius: 18px;
            color: var(--primary-color);
            background: none;
            font-weight: 500;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 14px;
        }

        .signin-btn:hover {
            background-color: #f2f8ff;
            border-color: transparent;
        }

        /* Sidebar */
        aside {
            position: fixed;
            top: 56px;
            left: 0;
            bottom: 0;
            width: 240px;
            background-color: var(--sidebar-bg);
            padding: 12px 0;
            overflow-y: auto;
            z-index: 900;
        }

        .sidebar-section {
            border-bottom: 1px solid var(--border-color);
            padding: 8px 0;
        }

        .sidebar-section:last-child {
            border-bottom: none;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 24px;
            padding: 0 24px;
            height: 40px;
            text-decoration: none;
            color: var(--text-color);
            font-size: 14px;
            cursor: pointer;
        }

        .sidebar-item:hover {
            background-color: var(--hover-bg);
        }

        .sidebar-item.active {
            background-color: var(--active-bg);
            font-weight: 500;
        }

        .sidebar-item.active svg {
            color: var(--primary-color);
            fill: var(--primary-color);
        }

        .sidebar-title {
            padding: 8px 24px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* Main Content */
        main {
            margin-top: 104px;
            margin-left: 240px;
            padding: 24px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 16px;
            row-gap: 40px;
            animation: fadeIn 0.4s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Video Card */
        .card {
            display: flex;
            flex-direction: column;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
        }

        .thumbnail-container {
            position: relative;
            width: 100%;
            aspect-ratio: 16 / 9;
            border-radius: 12px;
            overflow: hidden;
            background-color: #000;
            margin-bottom: 12px;
        }

        .thumbnail-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        /* Search Results horizontal layout */
        .card.horizontal {
            flex-direction: row !important;
            gap: 12px;
            padding: 8px 12px;
        }

        .card.horizontal .thumbnail-container {
            width: 160px;
            min-width: 160px;
            margin-bottom: 0;
            border-radius: 8px;
        }

        @media (min-width: 1000px) {
            .card.horizontal .thumbnail-container {
                width: 360px;
                min-width: 360px;
            }
            .card.horizontal .video-title {
                font-size: 18px;
            }
        }

        .card.horizontal .video-details {
            padding: 0;
            flex-direction: column;
            gap: 4px;
        }

        .card.horizontal .channel-avatar {
            display: none;
        }

        .card.horizontal .video-title {
            font-size: 14px;
            -webkit-line-clamp: 2;
        }

        /* Fluid suggested thumbnails for mobile */
        .suggested-card .thumbnail-container {
            width: 40%;
            min-width: 120px;
            margin-bottom: 0;
            border-radius: 8px;
        }

        /* Shorts Section */
        .shorts-container {
            grid-column: 1 / -1;
            padding: 16px 0;
            border-top: 4px solid var(--border-color);
            border-bottom: 4px solid var(--border-color);
            margin: 16px 0;
        }

        .shorts-header {
            display: flex;
            align-items: center;
            padding: 0 16px 12px;
            gap: 8px;
            font-weight: bold;
            font-size: 18px;
        }

        .shorts-grid {
            display: flex;
            overflow-x: auto;
            gap: 8px;
            padding: 0 16px;
            scrollbar-width: none;
        }

        .shorts-grid::-webkit-scrollbar {
            display: none;
        }

        .short-card {
            min-width: 150px;
            width: 150px;
            cursor: pointer;
        }

        .short-thumbnail {
            width: 100%;
            aspect-ratio: 9 / 16;
            border-radius: 12px;
            overflow: hidden;
            background-color: #222222;
            position: relative;
        }

        .short-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .short-title {
            margin-top: 8px;
            font-size: 14px;
            font-weight: 500;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .short-views {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .video-details {
            display: flex;
            gap: 12px;
        }

        .channel-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        /* Anda (Profile) View Styles */
        .anda-header {
            display: flex;
            padding: 16px;
            align-items: center;
            gap: 16px;
        }

        .anda-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            font-size: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .anda-info h2 {
            margin: 0;
            font-size: 24px;
        }

        .anda-info p {
            margin: 4px 0;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .anda-section {
            padding: 16px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .anda-section-header {
            display: flex;
            justify-content: space-between;
            padding: 0 16px 12px;
            font-weight: bold;
            font-size: 18px;
        }

        .anda-history-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            padding: 0 16px;
            gap: 12px;
        }

        @media (min-width: 601px) {
            .anda-history-list {
                display: flex;
                overflow-x: auto;
                scrollbar-width: none;
            }
            .anda-history-list::-webkit-scrollbar {
                display: none;
            }
            .anda-history-item {
                min-width: 160px;
                width: 160px;
            }
        }

        .anda-history-item {
            width: 100%;
        }

        .anda-history-thumb {
            width: 100%;
            aspect-ratio: 16/9;
            border-radius: 8px;
            overflow: hidden;
            background-color: #333;
        }

        .anda-history-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .anda-history-title {
            font-size: 12px;
            margin-top: 4px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .anda-menu-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            gap: 16px;
        }

        .user-avatar-small {
            width: 24px;
            height: 24px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }

        .video-info {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .video-title {
            font-size: 15px;
            font-weight: 500;
            margin: 0 0 4px 0;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.4;
            letter-spacing: 0.1px;
        }

        .channel-name {
            font-size: 13px;
            color: var(--text-secondary);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .video-meta {
            font-size: 13px;
            color: var(--text-secondary);
            margin: 0;
        }

        .loading {
            grid-column: 1 / -1;
            text-align: center;
            padding: 40px;
            color: var(--primary-color);
            font-weight: 500;
        }

        /* Notification Overlay */
        #notification-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            z-index: 2500;
            flex-direction: column;
            animation: slideInUp 0.3s ease-out;
        }

        .notif-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            gap: 16px;
        }

        .notif-list {
            flex-grow: 1;
            overflow-y: auto;
        }

        .notif-item {
            display: flex;
            padding: 12px 16px;
            gap: 12px;
            align-items: flex-start;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .notif-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background-color: var(--primary-color);
            flex-shrink: 0;
        }

        .notif-content {
            flex-grow: 1;
        }

        .notif-text {
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 4px;
        }

        .notif-time {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .notif-thumb {
            width: 60px;
            aspect-ratio: 16/9;
            border-radius: 4px;
            overflow: hidden;
            background-color: #333;
        }

        .notif-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        @keyframes slideInUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        /* Bottom Sheet */
        #create-sheet {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--sidebar-bg);
            z-index: 4000;
            border-radius: 12px 12px 0 0;
            flex-direction: column;
            padding-bottom: 24px;
            animation: slideInUp 0.3s ease-out;
        }

        .sheet-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            z-index: 3999;
        }

        .sheet-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            font-weight: bold;
            font-size: 18px;
        }

        .sheet-item {
            display: flex;
            align-items: center;
            padding: 16px;
            gap: 16px;
            cursor: pointer;
        }

        .sheet-item:active {
            background-color: var(--hover-bg);
        }

        .sheet-icon {
            width: 40px;
            height: 40px;
            background-color: var(--hover-bg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Modal Base */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0f0f0f;
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }

        /* Modal for playback - Mobile Optimized */
        #video-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-color);
            z-index: 5000;
            flex-direction: column;
            overflow-y: auto;
        }

        .ambient-glow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 40%;
            background: radial-gradient(circle at center, rgba(157, 78, 221, 0.4) 0%, rgba(15, 15, 15, 0) 70%);
            filter: blur(60px);
            z-index: 4999;
            pointer-events: none;
            transition: background 1s ease;
        }

        .video-player-container {
            width: 100%;
            background: black;
            position: sticky;
            top: 0;
            z-index: 5001;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .video-player-wrapper {
            width: 100%;
            position: relative;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
        }

        .video-player-wrapper.portrait {
            padding-bottom: 177.77%; /* 9:16 Aspect Ratio */
        }

        .video-player-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .video-details-page {
            padding: 12px;
        }

        /* Comments Section */
        .comments-preview {
            background-color: var(--hover-bg);
            padding: 12px;
            border-radius: 12px;
            margin-bottom: 16px;
            cursor: pointer;
        }

        .comments-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .comment-count {
            color: var(--text-secondary);
            font-weight: normal;
            font-size: 12px;
        }

        .user-comment-preview {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }

        .user-comment-preview .avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: #555;
        }

        /* Comments Overlay */
        #comments-overlay {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 70%;
            background-color: #0f0f0f;
            z-index: 6000;
            border-radius: 12px 12px 0 0;
            flex-direction: column;
            animation: slideInUp 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
        }

        .comments-overlay-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .comments-list {
            flex-grow: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .comment-item {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .comment-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .comment-body {
            flex-grow: 1;
        }

        .comment-user {
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 2px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .comment-time {
            color: var(--text-secondary);
            font-weight: normal;
        }

        .comment-text {
            font-size: 14px;
            line-height: 1.4;
        }

        .comment-actions {
            display: flex;
            gap: 16px;
            margin-top: 8px;
            color: var(--text-secondary);
            font-size: 12px;
        }

        .add-comment-bar {
            padding: 8px 16px;
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 12px;
            background-color: #0f0f0f;
        }

        .add-comment-input {
            flex-grow: 1;
            background-color: #1a1a1a;
            border: none;
            border-radius: 20px;
            padding: 10px 16px;
            color: white;
            font-size: 14px;
            outline: none;
        }

        .add-comment-input:focus {
            background-color: #272727;
        }

        .video-details-page h2 {
            font-size: 18px;
            margin: 0 0 8px 0;
            line-height: 1.4;
        }

        .video-details-page .meta {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .channel-info-bar {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .subs-count {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .subscribe-btn {
            margin-left: auto;
            background-color: white;
            color: black;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }

        .actions-bar {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 12px;
            scrollbar-width: none;
        }

        .actions-bar::-webkit-scrollbar {
            display: none;
        }

        .action-item {
            display: flex;
            align-items: center;
            background-color: var(--hover-bg);
            padding: 8px 16px;
            border-radius: 20px;
            gap: 6px;
            white-space: nowrap;
            font-size: 12px;
            font-weight: 500;
            transition: background 0.2s;
        }

        .action-item:active {
            background-color: var(--active-bg);
        }

        .action-item.active {
            background-color: rgba(157, 78, 221, 0.1) !important;
            color: var(--primary-color) !important;
        }

        .action-item.active svg {
            fill: var(--primary-color) !important;
        }

        .suggested-section {
            padding-top: 12px;
        }

        /* Mini Player */
        #mini-player {
            display: none;
            position: fixed;
            bottom: 56px;
            left: 8px;
            right: 8px;
            height: 64px;
            background-color: #282828;
            z-index: 1500;
            align-items: center;
            padding: 0 8px;
            border-radius: 12px;
            gap: 12px;
            animation: slideInUp 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            border: 1px solid #333;
        }

        .mini-player-thumb {
            width: 90px;
            aspect-ratio: 16/9;
            background: black;
            border-radius: 4px;
            overflow: hidden;
        }

        .mini-player-thumb iframe {
            width: 100%;
            height: 100%;
            pointer-events: none; /* Prevent interaction in mini player thumb */
        }

        .mini-player-info {
            flex-grow: 1;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .mini-player-title {
            font-weight: 500;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .mini-player-channel {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .mini-player-actions {
            display: flex;
            gap: 8px;
        }

        @media (min-width: 601px) {
            #mini-player {
                bottom: 16px;
                left: 256px;
                right: 16px;
            }
        }
        @media (max-width: 1000px) and (min-width: 601px) {
            #mini-player {
                left: 88px;
            }
        }

        /* Collapsible Description */
        .description-box {
            background-color: var(--hover-bg);
            padding: 12px;
            border-radius: 12px;
            margin-bottom: 16px;
            cursor: pointer;
        }

        .description-text {
            font-size: 14px;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .description-box.expanded .description-text {
            display: block;
            -webkit-line-clamp: unset;
        }

        .close-player-btn {
            position: absolute;
            top: 8px;
            left: 8px;
            z-index: 5002;
            background: rgba(0,0,0,0.5);
            border-radius: 50%;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .login-card {
            background-color: #0f0f0f;
            border: 1px solid var(--border-color);
            padding: 40px;
            border-radius: 12px;
            width: 100%;
            max-width: 400px;
            text-align: center;
            position: relative;
        }

        .login-card h2 {
            margin-bottom: 8px;
            color: white;
        }

        .login-card p {
            color: var(--text-secondary);
            margin-bottom: 24px;
            font-size: 14px;
        }

        .login-card input {
            width: 100%;
            padding: 12px;
            margin-bottom: 16px;
            background-color: #1a1a1a;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: white;
            outline: none;
        }

        .login-card input:focus {
            border-color: var(--primary-color);
        }

        .login-card .submit-btn {
            width: 100%;
            padding: 12px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
        }

        .login-card .submit-btn:hover {
            background-color: var(--primary-hover);
        }

        .login-card .close-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        /* Categories Bar */
        .categories-bar {
            position: fixed;
            top: 56px;
            left: 240px;
            right: 0;
            height: 48px;
            background-color: var(--header-bg);
            display: flex;
            align-items: center;
            padding: 0 12px;
            gap: 12px;
            overflow-x: auto;
            z-index: 800;
            scrollbar-width: none;
            border-bottom: 1px solid var(--border-color);
            transition: top 0.3s ease-in-out;
        }

        .categories-bar::-webkit-scrollbar {
            display: none;
        }

        .chip {
            background-color: var(--hover-bg);
            color: var(--text-color);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 14px;
            white-space: nowrap;
            cursor: pointer;
            border: 1px solid transparent;
            transition: background 0.2s;
        }

        .chip.active {
            background-color: white;
            color: black;
        }

        @media (max-width: 1000px) {
            aside {
                width: 72px;
            }
            .sidebar-item {
                padding: 0;
                flex-direction: column;
                height: 72px;
                justify-content: center;
                gap: 4px;
                font-size: 10px;
            }
            .sidebar-title, .sidebar-section:not(:first-child) {
                display: none;
            }
            main {
                margin-left: 72px;
            }
            .categories-bar {
                left: 72px;
            }
        }

        .bottom-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 56px;
            background-color: var(--header-bg);
            border-top: 1px solid var(--border-color);
            z-index: 1000;
            justify-content: space-around;
            align-items: center;
        }

        .nav-item {
            display: flex;
            flex: 1;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 10px;
            cursor: pointer;
            gap: 4px;
            height: 100%;
        }

        .nav-item:active {
            background-color: var(--hover-bg);
        }

        .nav-item svg {
            fill: currentColor;
        }

        .nav-item.active {
            color: white;
        }

        .nav-item.active svg {
            fill: var(--primary-color);
        }

        /* Toast Notification */
        #toast {
            visibility: hidden;
            min-width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 4px;
            padding: 12px;
            position: fixed;
            z-index: 6000;
            left: 50%;
            bottom: 80px;
            transform: translateX(-50%);
            font-size: 14px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        #toast.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @keyframes fadein {
            from {bottom: 50px; opacity: 0;}
            to {bottom: 80px; opacity: 1;}
        }

        @keyframes fadeout {
            from {bottom: 80px; opacity: 1;}
            to {bottom: 50px; opacity: 0;}
        }

        @media (max-width: 600px) {
            .mobile-only {
                display: flex;
            }
            .desktop-only {
                display: none;
            }
            header .header-center {
                display: none;
            }
            .header-left .menu-btn {
                display: none;
            }
            aside {
                display: none;
            }
            main {
                margin-top: 104px;
                margin-left: 0;
                padding: 0;
                margin-bottom: 56px;
            }
            .categories-bar {
                left: 0;
            }
            .bottom-nav {
                display: flex;
            }
            .grid {
                grid-template-columns: 1fr;
                gap: 0;
            }
            .card {
                margin-bottom: 16px;
                border-bottom: 1px solid var(--border-color);
                padding-bottom: 16px;
            }
            .thumbnail-container {
                border-radius: 0;
                margin-bottom: 8px;
            }
            .video-details {
                padding: 0 12px;
            }
            .video-title {
                font-size: 14px;
            }
            .channel-name, .video-meta {
                font-size: 12px;
            }
            .header-right {
                display: flex;
                gap: 12px;
            }
            .mobile-search-active header .header-center {
                display: flex;
                position: absolute;
                left: 0;
                right: 0;
                background: var(--header-bg);
                padding: 0 16px;
                max-width: 100%;
                z-index: 1001;
            }
            .mobile-search-active .header-left,
            .mobile-search-active .header-right {
                display: none;
            }
        }
    </style>
</head>
<body>

<header>
    <div class="header-left">
        <button class="menu-btn">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M21 6H3V5h18v1zm0 5H3v1h18v-1zm0 6H3v1h18v-1z"></path></svg>
        </button>
        <a href="/" class="logo">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="var(--primary-color)"><path d="M21.58 7.19c-.23-.86-.91-1.54-1.77-1.77C18.25 5 12 5 12 5s-6.25 0-7.81.42c-.86.23-1.54.91-1.77 1.77C2 8.75 2 12 2 12s0 3.25.42 4.81c.23.86.91 1.54 1.77 1.77C5.75 19 12 19 12 19s6.25 0 7.81-.42c.86-.23 1.54-.91 1.77-1.77.42-1.56.42-4.81.42-4.81s0-3.25-.42-4.81zM10 15V9l5.2 3-5.2 3z"/></svg>
            <span>Playtube</span>
        </a>
    </div>
    <div class="header-center">
        <button class="icon-btn mobile-only" id="mobile-search-back">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg>
        </button>
        <div class="search-wrapper">
            <input type="text" id="search-input" placeholder="Telusuri" autocomplete="off">
            <div id="search-suggestions" class="search-suggestions"></div>
            <button class="search-btn" id="search-btn">
                <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M20.87 20.17l-5.59-5.59C16.35 13.35 17 11.75 17 10c0-3.87-3.13-7-7-7s-7 3.13-7 7 3.13 7 7 7c1.75 0 3.35-.65 4.58-1.71l5.59 5.59.7-.71zM10 16c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"></path></svg>
            </button>
        </div>
        <button class="mic-btn">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M12 3c-1.66 0-3 1.34-3 3v7c0 1.66 1.34 3 3 3s3-1.34 3-3V6c0-1.66-1.34-3-3-3zM11 6c0-.55.45-1 1-1s1 .45 1 1v7c0 .55-.45 1-1 1s-1-.45-1-1V6zM18.91 13c-.49 0-.91.36-.98.84C17.42 17.07 14.91 19 12 19s-5.42-1.93-5.93-5.16c-.07-.48-.49-.84-.98-.84-.58 0-1.02.52-.95 1.1.63 4.39 4.01 7.82 8.36 8.75V25c0 .55.45 1 1 1s1-.45 1-1v-2.15c4.35-.93 7.73-4.36 8.36-8.75.07-.58-.37-1.1-.95-1.1z"></path></svg>
        </button>
    </div>
    <div class="header-right">
        <button class="icon-btn mobile-only" id="cast-btn">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm0-4v2c4.97 0 9 4.03 9 9h2c0-6.08-4.92-11-11-11zm20-7H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg>
        </button>
        <button class="icon-btn mobile-only" id="notif-btn">
            <div style="position: relative;">
                <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"></path></svg>
                <div style="position: absolute; top: -2px; right: -5px; background: red; color: white; font-size: 10px; border-radius: 8px; padding: 0 4px;">9+</div>
            </div>
        </button>
        <button class="icon-btn mobile-only" id="mobile-search-btn">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M20.87 20.17l-5.59-5.59C16.35 13.35 17 11.75 17 10c0-3.87-3.13-7-7-7s-7 3.13-7 7 3.13 7 7 7c1.75 0 3.35-.65 4.58-1.71l5.59 5.59.7-.71zM10 16c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"></path></svg>
        </button>
        <button class="login-btn desktop-only" id="header-login-btn">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>
            <span>Login</span>
        </button>
    </div>
</header>

<div class="categories-bar" id="categories-bar">
    <div class="chip active" onclick="selectChip(this, 'trending')">Semua</div>
    <div class="chip" onclick="selectChip(this, 'musik')">Musik</div>
    <div class="chip" onclick="selectChip(this, 'game')">Game</div>
    <div class="chip" onclick="selectChip(this, 'berita')">Berita</div>
    <div class="chip" onclick="selectChip(this, 'live')">Live</div>
    <div class="chip" onclick="selectChip(this, 'animasi')">Animasi</div>
    <div class="chip" onclick="selectChip(this, 'teknologi')">Teknologi</div>
    <div class="chip" onclick="selectChip(this, 'baru')">Baru diunggah</div>
</div>

<nav class="bottom-nav">
    <div class="nav-item active" onclick="loadTrending()">
        <svg height="24" viewBox="0 0 24 24" width="24"><path d="M4 10V21h6V15h4v6h6V10L12 3Z"></path></svg>
        <span>Beranda</span>
    </div>
    <div class="nav-item" onclick="loadSearch('shorts')">
        <svg height="24" viewBox="0 0 24 24" width="24"><path d="M17.77 10.32l-1.2-.5L18 8.82a3.74 3.74 0 00-2.39-6.75 3.7 3.7 0 00-1.51.32l-10 4.1a3.75 3.75 0 00-.07 7l1.2.5L4 15.18a3.75 3.75 0 002.46 6.76 3.7 3.7 0 001.46-.3l10-4.1a3.75 3.75 0 00.07-7l-.22-.12zM10 14.5v-5l5 2.5-5 2.5z"></path></svg>
        <span>Shorts</span>
    </div>
    <div class="nav-item" id="create-btn-mobile">
        <svg height="36" viewBox="0 0 24 24" width="36" fill="white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"></path></svg>
    </div>
    <div class="nav-item" onclick="loadSearch('subscriptions')">
        <svg height="24" viewBox="0 0 24 24" width="24"><path d="M10 18v-6l5 3-5 3zm7-15H7v1h10V3zm3 3H4v1h16V6zm2 3H2v12h20V9zM3 10h18v10H3V10z"></path></svg>
        <span>Subscription</span>
    </div>
    <div class="nav-item" id="mobile-anda-btn" onclick="loadAnda()">
        <div class="user-avatar-small">P</div>
        <span>Anda</span>
    </div>
</nav>

<aside>
    <div class="sidebar-section">
        <a class="sidebar-item active" onclick="loadTrending()">
            <svg height="24" viewBox="0 0 24 24" width="24"><path d="M4 10V21h6V15h4v6h6V10L12 3Z"></path></svg>
            <span>Beranda</span>
        </a>
        <a class="sidebar-item" onclick="loadTrending()">
            <svg height="24" viewBox="0 0 24 24" width="24"><path d="M10 14.65v-5.3L15 12l-5 2.65ZM13 13V7l5.2 3-5.2 3ZM22 13h-4v9h-2v-9h-2V7h8v6ZM2 13h1V7H2v6Zm3 0h1V7H5v6Zm3 0h1V7H8v6Z"></path></svg>
            <span>Trending</span>
        </a>
        <a class="sidebar-item">
            <svg height="24" viewBox="0 0 24 24" width="24"><path d="M20 7H4v10h16V7zm2-2v14H2V5h20zM7 14l5-3 5 3v-1l-5-3-5 3v1z"></path></svg>
            <span>Subscriptions</span>
        </a>
    </div>
    <div class="sidebar-section">
        <a class="sidebar-item" onclick="loadHistory()">
            <svg height="24" viewBox="0 0 24 24" width="24"><path d="M11 7l6 3.5-6 3.5V7zm7 13H4V6H3v15h15v-1zm3-2H6V3h15v15zM7 17h13V4H7v13z"></path></svg>
            <span>Koleksi</span>
        </a>
        <a class="sidebar-item" onclick="loadHistory()">
            <svg height="24" viewBox="0 0 24 24" width="24"><path d="M13 3a9 9 0 0 0-9 9H1l3.89 3.89.07.14L9 12H6a7 7 0 1 1 7 7 7.07 7.07 0 0 1-6-3.22l-1.44 1.44A9 9 0 1 0 13 3z"></path></svg>
            <span>Riwayat</span>
        </a>
    </div>
    <div class="sidebar-title">Best of Playtube</div>
    <div class="sidebar-section">
        <a class="sidebar-item" onclick="loadCategory(10)">
            <svg height="24" viewBox="0 0 24 24" width="24"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"></path></svg>
            <span>Musik</span>
        </a>
        <a class="sidebar-item" onclick="loadCategory(20)">
            <svg height="24" viewBox="0 0 24 24" width="24"><path d="M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-10 7H8v3H6v-3H3v-2h3V8h2v3h3v2zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4-3c-.83 0-1.5-.67-1.5-1.5S18.67 10 19.5 10s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"></path></svg>
            <span>Game</span>
        </a>
        <a class="sidebar-item" onclick="loadCategory(25)">
            <svg height="24" viewBox="0 0 24 24" width="24"><path d="M20 3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H5V5h14v14zM11 7h6v2h-6V7zm0 4h6v2h-6v-2zm-4 4h10v2H7v-2z"></path></svg>
            <span>Berita</span>
        </a>
        <a class="sidebar-item" onclick="loadSearch('live')">
            <svg height="24" viewBox="0 0 24 24" width="24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14.5v-9l6 4.5-6 4.5z"></path></svg>
            <span>Live</span>
        </a>
        <a class="sidebar-item" onclick="loadSearch('360 video')">
            <svg height="24" viewBox="0 0 24 24" width="24"><path d="M12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 18c4.41 0 8-3.59 8-8s-3.59-8-8-8-8 3.59-8 8 3.59 8 8 8zm-1-13h2v4h4v2h-4v4h-2v-4H7v-2h4V7z"></path></svg>
            <span>360Â° Video</span>
        </a>
    </div>
</aside>

<main>
    <div class="grid" id="results">
        <div class="loading">Memuat video...</div>
    </div>
</main>

<div id="mini-player">
    <div class="mini-player-thumb" id="mini-thumb"></div>
    <div class="mini-player-info">
        <div class="mini-player-title" id="mini-title">Judul Video</div>
        <div class="mini-player-channel" id="mini-channel">Nama Channel</div>
    </div>
    <div class="mini-player-actions">
        <button class="icon-btn" id="mini-play-pause">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg>
        </button>
        <button class="icon-btn" id="mini-close">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
        </button>
    </div>
</div>

<div id="video-modal">
    <div class="ambient-glow" id="ambient-glow"></div>
    <div class="video-player-container">
        <button class="icon-btn close-player-btn" id="close-player">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
        </button>
        <div class="video-player-wrapper" id="player-wrapper">
            <div id="player"></div>
        </div>
    </div>
    <div class="video-details-page" id="video-details-content">
        <!-- Details will be injected here -->
    </div>
    <div class="suggested-section" id="suggested-results">
        <!-- Suggested videos -->
    </div>
</div>

<div id="notification-overlay">
    <div class="notif-header">
        <button class="icon-btn" id="close-notif">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg>
        </button>
        <span style="font-size: 18px; font-weight: bold;">Notifikasi</span>
        <button class="icon-btn" style="margin-left: auto;">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg>
        </button>
    </div>
    <div class="notif-list" id="notif-list">
        <!-- Notif items here -->
    </div>
</div>

<div id="sheet-overlay" class="sheet-overlay"></div>
<div id="create-sheet">
    <div class="sheet-header">
        <span>Buat</span>
        <button class="icon-btn" id="close-sheet">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
        </button>
    </div>
    <div class="sheet-item">
        <div class="sheet-icon">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M10 14.65v-5.3L15 12l-5 2.65ZM13 13V7l5.2 3-5.2 3ZM22 13h-4v9h-2v-9h-2V7h8v6ZM2 13h1V7H2v6Zm3 0h1V7H5v6Zm3 0h1V7H8v6Z"></path></svg>
        </div>
        <span>Buat Short</span>
    </div>
    <div class="sheet-item">
        <div class="sheet-icon">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4zM14 13h-3v3H9v-3H6v-2h3V8h2v3h3v2z"></path></svg>
        </div>
        <span>Upload video</span>
    </div>
    <div class="sheet-item">
        <div class="sheet-icon">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14.5v-9l6 4.5-6 4.5z"></path></svg>
        </div>
        <span>Live</span>
    </div>
</div>

<div id="comments-overlay">
    <div class="comments-overlay-header">
        <span style="font-weight: bold; font-size: 18px;">Komentar</span>
        <button class="icon-btn" id="close-comments">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
        </button>
    </div>
    <div class="comments-list" id="comments-list">
        <!-- Comments will be injected here -->
    </div>
    <div class="add-comment-bar">
        <div class="user-avatar-small">P</div>
        <input type="text" class="add-comment-input" id="new-comment-input" placeholder="Tambahkan komentar...">
        <button class="icon-btn" id="send-comment-btn" style="color: var(--primary-color)">
            <svg height="24" viewBox="0 0 24 24" width="24" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
        </button>
    </div>
</div>

<div id="toast">Pesan muncul di sini</div>

<div id="login-modal" class="modal">
    <div class="login-card">
        <button class="close-btn" id="close-login">&times;</button>
        <h2>Login ke Playtube</h2>
        <p>Gunakan akun Playtube Anda</p>
        <form id="login-form">
            <input type="text" placeholder="Email atau nomor telepon" required>
            <input type="password" placeholder="Sandi" required>
            <div style="text-align: left; margin-bottom: 24px;">
                <a href="#" style="color: var(--primary-color); font-size: 14px; text-decoration: none;">Lupa sandi?</a>
            </div>
            <button type="submit" class="submit-btn">Berikutnya</button>
        </form>
        <p style="margin-top: 24px; font-size: 14px;">
            Bukan perangkat Anda? Gunakan jendela Tamu untuk login secara pribadi.
        </p>
    </div>
</div>

<script>
    const resultsGrid = document.getElementById('results');
    const searchInput = document.getElementById('search-input');
    const searchBtn = document.getElementById('search-btn');
    const videoModal = document.getElementById('video-modal');
    const closePlayer = document.getElementById('close-player');
    const playerContainer = document.getElementById('player');

    async function fetchVideos(url, layout = 'vertical') {
        resultsGrid.innerHTML = '';
        resultsGrid.style.animation = 'none';
        resultsGrid.offsetHeight; // trigger reflow
        resultsGrid.style.animation = null;
        renderSkeletons();
        try {
            const res = await fetch(url);
            const data = await res.json();
            if (data.items && data.items.length > 0) {
                renderVideos(data.items, layout);
            } else {
                renderMockVideos(layout);
            }
        } catch (error) {
            console.error(error);
            renderMockVideos(layout);
        }
    }

    function renderSkeletons() {
        resultsGrid.innerHTML = '';
        for (let i = 0; i < 8; i++) {
            const skeleton = document.createElement('div');
            skeleton.className = 'card';
            skeleton.innerHTML = `
                <div class="skeleton skeleton-thumb"></div>
                <div class="video-details" style="padding: 0 12px;">
                    <div class="skeleton skeleton-avatar"></div>
                    <div class="video-info">
                        <div class="skeleton skeleton-text skeleton-title"></div>
                        <div class="skeleton skeleton-text skeleton-meta"></div>
                    </div>
                </div>
            `;
            resultsGrid.appendChild(skeleton);
        }
    }

    function renderMockVideos(layout = 'vertical') {
        const mockItems = [];
        for (let i = 1; i <= 8; i++) {
            mockItems.push({
                id: 'mock' + i,
                snippet: {
                    title: 'Contoh Video Playtube ' + i + ' - Belajar Desain UI/UX',
                    channelTitle: 'Playtube Channel',
                    thumbnails: { high: { url: `https://picsum.photos/seed/pt${i}/480/270` } }
                }
            });
        }
        renderVideos(mockItems, layout);
    }

    // History logic
    let watchHistory = JSON.parse(localStorage.getItem('playtube_history') || '[]');

    function addToHistory(video) {
        watchHistory = JSON.parse(localStorage.getItem('playtube_history') || '[]').filter(item => {
            const id1 = typeof item.id === 'string' ? item.id : item.id.videoId;
            const id2 = typeof video.id === 'string' ? video.id : video.id.videoId;
            return id1 !== id2;
        });
        watchHistory.unshift(video);
        if (watchHistory.length > 50) watchHistory.pop();
        localStorage.setItem('playtube_history', JSON.stringify(watchHistory));
    }

    function loadHistory() {
        setActiveSidebar('Riwayat');
        renderVideos(watchHistory);
        if (watchHistory.length === 0) {
            resultsGrid.innerHTML = '<div class="loading" style="grid-column: 1/-1; text-align: center; margin-top: 50px;">Belum ada riwayat tontonan.</div>';
        }
    }

    function renderVideos(items, layout = 'vertical') {
        resultsGrid.innerHTML = '';
        if (!items || items.length === 0) {
            resultsGrid.innerHTML = '<div class="loading">Tidak ada hasil.</div>';
            return;
        }

        items.forEach((video, index) => {
            const videoId = typeof video.id === 'string' ? video.id : video.id.videoId;
            const snippet = video.snippet;
            if (!videoId) return;

            // Add Shorts section after 4th video
            if (index === 4) {
                renderShortsSection(resultsGrid);
            }

            const card = document.createElement('div');
            card.className = `card ${layout === 'horizontal' ? 'horizontal' : ''}`;
            card.onclick = () => {
                addToHistory(video);
                openVideo(videoId, video);
            };

            const initials = snippet.channelTitle.charAt(0).toUpperCase();

            card.innerHTML = `
                <div class="thumbnail-container">
                    <img src="${snippet.thumbnails.high.url}" alt="">
                </div>
                <div class="video-details">
                    <div class="channel-avatar">${initials}</div>
                    <div class="video-info">
                        <h3 class="video-title"></h3>
                        <p class="channel-name"></p>
                        <p class="video-meta"></p>
                    </div>
                    <div style="margin-left: auto; padding-top: 4px;">
                        <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg>
                    </div>
                </div>
            `;

            // Set text content safely
            const titleEl = card.querySelector('.video-title');
            titleEl.textContent = snippet.title;
            titleEl.title = snippet.title;

            card.querySelector('.channel-name').textContent = snippet.channelTitle;
            card.querySelector('.video-meta').textContent = `${getRandomViews()} â¢ ${getRandomTime()}`;
            resultsGrid.appendChild(card);
        });
    }

    function renderShortsSection(container) {
        const section = document.createElement('div');
        section.className = 'shorts-container';

        section.innerHTML = `
            <div class="shorts-header">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="#ff0000"><path d="M17.77 10.32l-1.2-.5L18 8.82a3.74 3.74 0 00-2.39-6.75 3.7 3.7 0 00-1.51.32l-10 4.1a3.75 3.75 0 00-.07 7l1.2.5L4 15.18a3.75 3.75 0 002.46 6.76 3.7 3.7 0 001.46-.3l10-4.1a3.75 3.75 0 00.07-7l-.22-.12zM10 14.5v-5l5 2.5-5 2.5z"></path></svg>
                <span>Shorts</span>
            </div>
            <div class="shorts-grid">
                ${[1,2,3,4,5].map(i => {
                    const shortVideo = {
                        id: 'mock-short-' + i,
                        snippet: {
                            title: `Video Shorts Menarik ${i} #shorts`,
                            channelTitle: 'Shorts Channel',
                            thumbnails: { high: { url: `https://picsum.photos/seed/short${i}/200/350` } }
                        }
                    };
                    return `
                    <div class="short-card" onclick="openVideo('mock-short-${i}', ${JSON.stringify(shortVideo).replace(/"/g, '&quot;')}, true)">
                        <div class="short-thumbnail">
                            <img src="https://picsum.photos/seed/short${i}/200/350" alt="">
                            <div style="position: absolute; bottom: 8px; left: 8px; color: white; font-size: 10px; font-weight: bold; background: rgba(0,0,0,0.6); padding: 2px 4px; border-radius: 2px;">SHORTS</div>
                        </div>
                        <div class="short-title">Video Shorts Menarik ${i} #shorts</div>
                        <div class="short-views">${Math.floor(Math.random()*100)+1} jt x ditonton</div>
                    </div>
                    `;
                }).join('')}
            </div>
        `;
        container.appendChild(section);
    }

    function getRandomViews() {
        const views = Math.floor(Math.random() * 1000) + 1;
        return views + " rb x ditonton";
    }

    function getRandomTime() {
        const times = ["1 jam yang lalu", "5 jam yang lalu", "1 hari yang lalu", "3 hari yang lalu", "1 minggu yang lalu", "1 bulan yang lalu"];
        return times[Math.floor(Math.random() * times.length)];
    }

    let currentVideoData = null;

    async function openVideo(videoId, videoData, isShort = false) {
        currentVideoData = videoData || {
            snippet: {
                title: 'Video Playtube Menarik',
                channelTitle: 'Playtube Channel'
            }
        };

        const player = document.getElementById('player');
        const wrapper = document.getElementById('player-wrapper');

        if (isShort) {
            wrapper.classList.add('portrait');
        } else {
            wrapper.classList.remove('portrait');
        }

        if (!player.querySelector('iframe') || !player.querySelector('iframe').src.includes(videoId)) {
            player.innerHTML = `<iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1" allow="autoplay; fullscreen" allowfullscreen></iframe>`;
        }

        // Set ambient glow color randomly from a set of nice colors or purple shades
        const colors = ['rgba(157, 78, 221, 0.4)', 'rgba(123, 44, 191, 0.4)', 'rgba(90, 24, 154, 0.4)', 'rgba(60, 9, 108, 0.4)'];
        const randomColor = colors[Math.floor(Math.random() * colors.length)];
        document.getElementById('ambient-glow').style.background = `radial-gradient(circle at center, ${randomColor} 0%, rgba(15, 15, 15, 0) 70%)`;

        // Ensure player is in modal
        wrapper.appendChild(player);

        videoModal.style.display = 'flex';
        document.getElementById('mini-player').style.display = 'none';
        document.body.style.overflow = 'hidden';

        // Inject video info
        const content = document.getElementById('video-details-content');
        const initials = currentVideoData.snippet.channelTitle.charAt(0).toUpperCase();

        content.innerHTML = `
            <h2 id="player-video-title" style="font-size: 16px;"></h2>
            <div class="meta">${getRandomViews()} â¢ ${getRandomTime()} ...lebih banyak</div>

            <div class="channel-info-bar">
                <div class="channel-avatar">${initials}</div>
                <div>
                    <div id="player-channel-name" style="font-weight: bold; font-size: 14px;"></div>
                    <div class="subs-count">${Math.floor(Math.random() * 10) + 1} jt subscriber</div>
                </div>
                <button class="subscribe-btn" id="subscribe-btn-player">Subscribe</button>
            </div>

            <div class="actions-bar">
                <div class="action-item" onclick="toggleAction(this, 'liked')">
                    <svg height="20" viewBox="0 0 24 24" width="20" fill="white"><path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"></path></svg>
                    <span>12 rb</span>
                </div>
                <div class="action-item" onclick="toggleAction(this, 'disliked')">
                    <svg height="20" viewBox="0 0 24 24" width="20" fill="white"><path d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.37-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"></path></svg>
                </div>
                <div class="action-item" onclick="shareVideo('${videoId}')">
                    <svg height="20" viewBox="0 0 24 24" width="20" fill="white"><path d="M11.73 15.83L11 14l1.73-1.83L15 13l-3.27 2.83zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 14.5v-9l6 4.5-6 4.5z"></path></svg>
                    <span>Bagikan</span>
                </div>
                <div class="action-item" onclick="showToast('Video didownload')">
                    <svg height="20" viewBox="0 0 24 24" width="20" fill="white"><path d="M17 18V5H7v13h10zm1-14c.55 0 1 .45 1 1v14c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1V5c0-.55.45-1 1-1h12zM8 7h3v2H8V7zm0 4h8v2H8v-2zm0 4h8v2H8v-2z"></path></svg>
                    <span>Download</span>
                </div>
                <div class="action-item" onclick="showToast('Disimpan ke Koleksi')">
                    <svg height="20" viewBox="0 0 24 24" width="20" fill="white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"></path></svg>
                    <span>Simpan</span>
                </div>
            </div>

            <div class="description-box" id="description-trigger">
                <div class="description-text">
                    Deskripsi untuk video ini: ${currentVideoData.snippet.title}. Video ini memberikan wawasan baru tentang topik yang sedang hangat diperbincangkan. Pastikan untuk menonton sampai habis agar tidak ketinggalan informasi penting!
                </div>
            </div>

            <div class="comments-preview" id="comments-preview-trigger">
                <div class="comments-header">
                    <span>Komentar</span>
                    <span class="comment-count" id="preview-comment-count">12 rb</span>
                </div>
                <div class="user-comment-preview">
                    <div class="avatar" id="preview-avatar"></div>
                    <div id="preview-comment-text">Wah videonya keren banget, sangat informatif!</div>
                </div>
            </div>
        `;

        document.getElementById('player-video-title').textContent = currentVideoData.snippet.title;
        const channelName = currentVideoData.snippet.channelTitle;
        document.getElementById('player-channel-name').textContent = channelName;

        const subBtn = document.getElementById('subscribe-btn-player');
        updateSubscribeButton(subBtn, channelName);
        subBtn.onclick = () => toggleSubscribe(subBtn, channelName);

        document.getElementById('description-trigger').onclick = function() {
            this.classList.toggle('expanded');
        };

        document.getElementById('comments-preview-trigger').onclick = () => openComments(videoId);

        // Inject suggested videos
        const suggested = document.getElementById('suggested-results');
        suggested.innerHTML = '<div class="loading">Memuat saran...</div>';

        // Use trending as suggested for now
        try {
            const res = await fetch('/api/trending');
            const data = await res.json();
            renderSuggestedVideos(data.items || []);
        } catch(e) {
            renderSuggestedVideos([]);
        }
    }

    function renderSuggestedVideos(items) {
        const suggested = document.getElementById('suggested-results');
        suggested.innerHTML = '';
        const list = items.length > 0 ? items : Array(5).fill(0).map((_,i)=>({
            id: 'suggest'+i,
            snippet: { title: 'Video Terkait ' + (i+1), channelTitle: 'Recommended Channel', thumbnails: { high: { url: `https://picsum.photos/seed/sug${i}/480/270` }}}
        }));

        list.forEach(v => {
            const videoId = typeof v.id === 'string' ? v.id : v.id.videoId;
            const card = document.createElement('div');
            card.className = 'card suggested-card';
            card.style.flexDirection = 'row';
            card.style.padding = '8px 12px';
            card.style.gap = '12px';
            card.onclick = () => openVideo(videoId);
            card.innerHTML = `
                <div class="thumbnail-container">
                    <img src="${v.snippet.thumbnails.high.url}" alt="">
                </div>
                <div class="video-info">
                    <h3 class="video-title" style="font-size: 14px;"></h3>
                    <p class="channel-name" style="font-size: 12px;"></p>
                    <p class="video-meta" style="font-size: 12px;"></p>
                </div>
            `;
            card.querySelector('.video-title').textContent = v.snippet.title;
            card.querySelector('.channel-name').textContent = v.snippet.channelTitle;
            card.querySelector('.video-meta').textContent = getRandomViews() + ' â¢ ' + getRandomTime();
            suggested.appendChild(card);
        });
    }

    closePlayer.onclick = () => {
        videoModal.style.display = 'none';
        document.getElementById('comments-overlay').style.display = 'none';
        document.body.style.overflow = 'auto';

        const mini = document.getElementById('mini-player');
        mini.style.display = 'flex';
        document.getElementById('mini-title').textContent = currentVideoData.snippet.title;
        document.getElementById('mini-channel').textContent = currentVideoData.snippet.channelTitle;

        // Move player to mini thumb
        document.getElementById('mini-thumb').appendChild(document.getElementById('player'));
    };

    document.getElementById('mini-player').onclick = (e) => {
        if (e.target.closest('#mini-close')) {
            document.getElementById('mini-player').style.display = 'none';
            document.getElementById('player').innerHTML = '';
            return;
        }
        if (e.target.closest('#mini-play-pause')) {
            return;
        }
        // Re-open
        const iframe = document.querySelector('#player iframe');
        if (iframe) {
            const videoId = iframe.src.split('/').pop().split('?')[0];
            const isShort = document.getElementById('player-wrapper').classList.contains('portrait');
            openVideo(videoId, currentVideoData, isShort);
        }
    };

    window.onclick = (event) => {
        if (event.target == videoModal) {
            closePlayer.onclick();
        }
        if (event.target == loginModal) {
            loginModal.style.display = 'none';
        }
    };

    function loadTrending() {
        setActiveSidebar('Beranda');
        fetchVideos('/api/trending');
    }

    function loadCategory(id) {
        setActiveSidebar(null, id);
        fetchVideos(`/api/category?id=${id}`);
    }

    function loadSearch(q) {
        setActiveSidebar(null, null, q);
        fetchVideos(`/api/search?q=${encodeURIComponent(q)}`, 'horizontal');
    }

    function loadAnda() {
        setActiveSidebar('Anda');
        resultsGrid.innerHTML = `
            <div class="anda-header">
                <div class="anda-avatar" style="background-color: var(--primary-color)">P</div>
                <div class="anda-info">
                    <h2 style="font-size: 20px; font-weight: 700;">Playtube Premium User</h2>
                    <p style="font-size: 13px;">@playtube_dev â¢ Lihat channel ></p>
                    <div style="display: flex; gap: 8px; margin-top: 12px;">
                        <button style="background: var(--hover-bg); border: none; color: white; padding: 8px 16px; border-radius: 20px; font-size: 12px; font-weight: 500; display: flex; align-items: center; gap: 6px;">
                            <svg height="18" viewBox="0 0 24 24" width="18" fill="white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"></path></svg>
                            Ganti akun
                        </button>
                        <button style="background: var(--hover-bg); border: none; color: white; padding: 8px 16px; border-radius: 20px; font-size: 12px; font-weight: 500; display: flex; align-items: center; gap: 6px;">
                            <svg height="18" viewBox="0 0 24 24" width="18" fill="white"><path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM11 7H13V9H11V7ZM11 11H13V17H11V11Z"></path></svg>
                            Bantuan
                        </button>
                    </div>
                </div>
            </div>

            <div class="anda-section">
                <div class="anda-section-header">
                    <span>Riwayat</span>
                    <button style="background: none; border: 1px solid var(--border-color); color: white; padding: 6px 16px; border-radius: 20px; font-size: 12px; font-weight: 500;">Lihat semua</button>
                </div>
                <div class="anda-history-list">
                    ${watchHistory.length > 0 ? watchHistory.map(v => {
                        const videoId = typeof v.id === 'string' ? v.id : v.id.videoId;
                        return `
                        <div class="anda-history-item" onclick="openVideo('${videoId}')">
                            <div class="anda-history-thumb">
                                <img src="${v.snippet.thumbnails.high.url}" alt="">
                            </div>
                            <div class="anda-history-title" style="font-weight: 500; margin-top: 8px;">${v.snippet.title}</div>
                        </div>
                        `;
                    }).join('') : `
                        <div style="padding: 24px; text-align: center; width: 100%;">
                            <svg height="48" viewBox="0 0 24 24" width="48" fill="var(--text-secondary)" style="margin-bottom: 12px;"><path d="M13 3a9 9 0 0 0-9 9H1l3.89 3.89.07.14L9 12H6a7 7 0 1 1 7 7 7.07 7.07 0 0 1-6-3.22l-1.44 1.44A9 9 0 1 0 13 3z"></path></svg>
                            <p style="color: var(--text-secondary); font-size: 14px;">Belum ada riwayat tontonan</p>
                        </div>
                    `}
                </div>
            </div>

            <div class="anda-section" style="border-bottom: none; padding-top: 8px;">
                <div class="anda-menu-item" style="border-radius: 12px; margin: 4px 16px; background: rgba(255,255,255,0.03);">
                    <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M10 14.65v-5.3L15 12l-5 2.65ZM13 13V7l5.2 3-5.2 3ZM22 13h-4v9h-2v-9h-2V7h8v6ZM2 13h1V7H2v6Zm3 0h1V7H5v6Zm3 0h1V7H8v6Z"></path></svg>
                    <div style="flex-grow: 1;">
                        <div style="font-weight: 500;">Video Anda</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">12 video</div>
                    </div>
                    <svg height="24" viewBox="0 0 24 24" width="24" fill="var(--text-secondary)"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"></path></svg>
                </div>
                <div class="anda-menu-item" style="border-radius: 12px; margin: 4px 16px;">
                    <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M17 18V5H7v13h10zm1-14c.55 0 1 .45 1 1v14c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1V5c0-.55.45-1 1-1h12zM8 7h3v2H8V7zm0 4h8v2H8v-2zm0 4h8v2H8v-2z"></path></svg>
                    <div style="flex-grow: 1;">
                        <div style="font-weight: 500;">Download</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">20 video â¢ Disimpan ke Playtube</div>
                    </div>
                </div>
                <div class="anda-menu-item" style="border-radius: 12px; margin: 4px 16px;">
                    <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>
                    <div style="flex-grow: 1;">
                        <div style="font-weight: 500;">Video yang disukai</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">156 video</div>
                    </div>
                </div>

                <div style="padding: 16px 32px; font-weight: bold; font-size: 16px;">Setelan</div>

                <div class="anda-menu-item" style="border-radius: 12px; margin: 4px 16px;">
                    <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"></path></svg>
                    <span>Setelan</span>
                </div>
            </div>
        `;
    }

    function setActiveSidebar(text, categoryId, query) {
        const items = document.querySelectorAll('.sidebar-item');
        items.forEach(item => {
            item.classList.remove('active');
            if (text && item.innerText.includes(text)) {
                item.classList.add('active');
            }
        });

        // Update bottom nav
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => {
            item.classList.remove('active');
            if (text && item.innerText.includes(text)) {
                item.classList.add('active');
            }
        });
    }

    // Search Suggestions Logic
    const suggestionsBox = document.getElementById('search-suggestions');
    let recentSearches = JSON.parse(localStorage.getItem('playtube_recent_searches') || '[]');

    function updateRecentSearches(q) {
        recentSearches = recentSearches.filter(item => item !== q);
        recentSearches.unshift(q);
        if (recentSearches.length > 10) recentSearches.pop();
        localStorage.setItem('playtube_recent_searches', JSON.stringify(recentSearches));
    }

    function showSuggestions() {
        const q = searchInput.value;
        if (q === '' && recentSearches.length > 0) {
            suggestionsBox.innerHTML = recentSearches.map(item => `
                <div class="suggestion-item" onclick="selectSuggestion('${item}')">
                    <svg height="24" viewBox="0 0 24 24" width="24" fill="currentColor"><path d="M13 3a9 9 0 0 0-9 9H1l3.89 3.89.07.14L9 12H6a7 7 0 1 1 7 7 7.07 7.07 0 0 1-6-3.22l-1.44 1.44A9 9 0 1 0 13 3z"></path></svg>
                    <span>${item}</span>
                </div>
            `).join('');
            suggestionsBox.style.display = 'block';
        } else if (q.length > 0) {
            // Mock suggestions
            const mocks = [q, q + ' musik', q + ' shorts', q + ' trending', q + ' gaming'];
            suggestionsBox.innerHTML = mocks.map(item => `
                <div class="suggestion-item" onclick="selectSuggestion('${item}')">
                    <svg height="24" viewBox="0 0 24 24" width="24" fill="currentColor"><path d="M20.87 20.17l-5.59-5.59C16.35 13.35 17 11.75 17 10c0-3.87-3.13-7-7-7s-7 3.13-7 7 3.13 7 7 7c1.75 0 3.35-.65 4.58-1.71l5.59 5.59.7-.71zM10 16c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"></path></svg>
                    <span>${item}</span>
                </div>
            `).join('');
            suggestionsBox.style.display = 'block';
        } else {
            suggestionsBox.style.display = 'none';
        }
    }

    function selectSuggestion(val) {
        searchInput.value = val;
        suggestionsBox.style.display = 'none';
        loadSearch(val);
    }

    searchInput.addEventListener('focus', showSuggestions);
    searchInput.addEventListener('input', showSuggestions);
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.search-wrapper')) {
            suggestionsBox.style.display = 'none';
        }
    });

    searchBtn.onclick = () => {
        const q = searchInput.value;
        if (q) {
            updateRecentSearches(q);
            loadSearch(q);
        }
    };

    searchInput.onkeypress = (e) => {
        if (e.key === 'Enter') {
            const q = searchInput.value;
            if (q) {
                updateRecentSearches(q);
                loadSearch(q);
            }
            suggestionsBox.style.display = 'none';
            searchInput.blur();
        }
    };

    // Create Sheet Logic
    const createBtn = document.getElementById('create-btn-mobile');
    const createSheet = document.getElementById('create-sheet');
    const sheetOverlay = document.getElementById('sheet-overlay');
    const closeSheet = document.getElementById('close-sheet');

    createBtn.onclick = () => {
        createSheet.style.display = 'flex';
        sheetOverlay.style.display = 'block';
    };

    const hideSheet = () => {
        createSheet.style.display = 'none';
        sheetOverlay.style.display = 'none';
    };

    closeSheet.onclick = hideSheet;
    sheetOverlay.onclick = hideSheet;

    // Notification Logic
    const notifBtn = document.getElementById('notif-btn');
    const notifOverlay = document.getElementById('notification-overlay');
    const closeNotif = document.getElementById('close-notif');
    const notifList = document.getElementById('notif-list');

    notifBtn.onclick = () => {
        renderNotifications();
        notifOverlay.style.display = 'flex';
    };

    closeNotif.onclick = () => {
        notifOverlay.style.display = 'none';
    };

    function renderNotifications() {
        const mockNotifs = [
            { user: 'Budi Gaming', action: 'mengupload: Review HP Terbaru 2024!', time: '2 jam yang lalu', img: 'https://picsum.photos/seed/n1/60/34' },
            { user: 'Susi Masak', action: 'mengupload: Resep Rendang Enak', time: '5 jam yang lalu', img: 'https://picsum.photos/seed/n2/60/34' },
            { user: 'Playtube', action: 'Selamat datang di Playtube!', time: '1 hari yang lalu', img: 'https://picsum.photos/seed/n3/60/34' },
            { user: 'Tekno Indo', action: 'Sedang LIVE: Apple Event', time: '2 hari yang lalu', img: 'https://picsum.photos/seed/n4/60/34' },
            { user: 'Music Channel', action: 'Video baru: Lagu Hits 2024', time: '3 hari yang lalu', img: 'https://picsum.photos/seed/n5/60/34' }
        ];

        notifList.innerHTML = mockNotifs.map(n => `
            <div class="notif-item">
                <div class="notif-avatar" style="background-image: url('https://ui-avatars.com/api/?name=${n.user}&background=random'); background-size: cover;"></div>
                <div class="notif-content">
                    <div class="notif-text"><b>${n.user}</b> ${n.action}</div>
                    <div class="notif-time">${n.time}</div>
                </div>
                <div class="notif-thumb">
                    <img src="${n.img}" alt="">
                </div>
                <div style="padding-left: 8px;">
                    <svg height="24" viewBox="0 0 24 24" width="24" fill="white"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg>
                </div>
            </div>
        `).join('');
    }

    // Modal & Login Logic
    const loginModal = document.getElementById('login-modal');
    const closeLogin = document.getElementById('close-login');
    const headerLoginBtn = document.getElementById('header-login-btn');
    const mobileAndaBtn = document.getElementById('mobile-anda-btn');
    const loginForm = document.getElementById('login-form');
    const mobileSearchBtn = document.getElementById('mobile-search-btn');

    const mobileSearchBack = document.getElementById('mobile-search-back');

    mobileSearchBtn.onclick = () => {
        document.body.classList.add('mobile-search-active');
        searchInput.focus();
    };

    mobileSearchBack.onclick = () => {
        document.body.classList.remove('mobile-search-active');
    };

    function checkLogin() {
        if (!localStorage.getItem('playtube_logged_in')) {
            loginModal.style.display = 'flex';
            closeLogin.style.display = 'none'; // Force login
        } else {
            loginModal.style.display = 'none';
        }
    }

    headerLoginBtn.onclick = () => loginModal.style.display = 'flex';
    // Removed duplicate onclick for mobileAndaBtn as it's now handled in the HTML
    closeLogin.onclick = () => loginModal.style.display = 'none';

    loginForm.onsubmit = (e) => {
        e.preventDefault();
        localStorage.setItem('playtube_logged_in', 'true');
        alert('Login berhasil! (Simulasi)');
        loginModal.style.display = 'none';
        loadTrending();
    };

    // Sidebar navigation interactivity
    document.querySelectorAll('.sidebar-item').forEach(item => {
        item.addEventListener('click', () => {
            document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
            item.classList.add('active');
        });
    });

    function selectChip(el, category) {
        document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
        if (category === 'trending') loadTrending();
        else loadSearch(category);
        showToast("Memuat kategori: " + el.textContent);
    }

    // Header Auto-hide on Scroll
    let lastScrollY = window.scrollY;
    const headerEl = document.querySelector('header');
    const categoriesBar = document.getElementById('categories-bar');

    window.addEventListener('scroll', () => {
        if (window.innerWidth > 600) return;

        if (window.scrollY > lastScrollY && window.scrollY > 100) {
            headerEl.style.transform = 'translateY(-100%)';
            categoriesBar.style.top = '0';
        } else {
            headerEl.style.transform = 'translateY(0)';
            categoriesBar.style.top = '56px';
        }
        lastScrollY = window.scrollY;
    });

    function showToast(message) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.className = 'show';
        setTimeout(() => { toast.className = toast.className.replace('show', ''); }, 3000);
    }

    // Ripple Effect Logic
    document.addEventListener('click', function(e) {
        const target = e.target.closest('.nav-item, .card, .action-item, .chip, .sheet-item, .sidebar-item, .icon-btn, .login-btn, .subscribe-btn, .signin-btn');
        if (target) {
            const rect = target.getBoundingClientRect();
            const diameter = Math.max(target.clientWidth, target.clientHeight);
            const radius = diameter / 2;

            const circle = document.createElement("span");
            circle.style.width = circle.style.height = `${diameter}px`;
            circle.style.left = `${e.clientX - rect.left - radius}px`;
            circle.style.top = `${e.clientY - rect.top - radius}px`;
            circle.classList.add("ripple");

            target.classList.add('ripple-container');
            const oldRipple = target.querySelector('.ripple');
            if (oldRipple) oldRipple.remove();

            target.appendChild(circle);

            setTimeout(() => {
                if (circle.parentElement) circle.remove();
            }, 600);
        }
    });

    // Comments Logic
    function openComments(videoId) {
        const overlay = document.getElementById('comments-overlay');
        overlay.style.display = 'flex';
        renderComments(videoId);
    }

    document.getElementById('close-comments').onclick = () => {
        document.getElementById('comments-overlay').style.display = 'none';
    };

    function renderComments(videoId) {
        const list = document.getElementById('comments-list');
        const storageKey = 'comments_' + videoId;
        const userComments = JSON.parse(localStorage.getItem(storageKey) || '[]');

        const mockComments = [
            { user: 'Andi Pratama', text: 'Keren banget bang tutorialnya!', time: '1 jam yang lalu' },
            { user: 'Siti Aminah', text: 'Sangat membantu buat tugas kuliah saya.', time: '3 jam yang lalu' },
            { user: 'Budi Santoso', text: 'Ditunggu part 2-nya ya bang.', time: '5 jam yang lalu' }
        ];

        const allComments = [...userComments.slice().reverse(), ...mockComments];

        list.innerHTML = allComments.map(c => `
            <div class="comment-item">
                <div class="comment-avatar" style="background-color: ${stringToColor(c.user)}">${c.user.charAt(0)}</div>
                <div class="comment-body">
                    <div class="comment-user">${c.user} <span class="comment-time">${c.time}</span></div>
                    <div class="comment-text">${c.text}</div>
                    <div class="comment-actions">
                        <span onclick="showToast('Suka komentar')">Suka</span>
                        <span onclick="showToast('Balas komentar')">Balas</span>
                    </div>
                </div>
            </div>
        `).join('');

        // Update preview
        if (allComments.length > 0) {
            document.getElementById('preview-comment-text').textContent = allComments[0].text;
            const previewAvatar = document.getElementById('preview-avatar');
            previewAvatar.style.backgroundColor = stringToColor(allComments[0].user);
            previewAvatar.textContent = allComments[0].user.charAt(0);
            previewAvatar.style.display = 'flex';
            previewAvatar.style.alignItems = 'center';
            previewAvatar.style.justifyContent = 'center';
            previewAvatar.style.color = 'white';
            previewAvatar.style.fontWeight = 'bold';
            previewAvatar.style.fontSize = '12px';
            document.getElementById('preview-comment-count').textContent = (allComments.length + 12000).toLocaleString('id-ID');
        }
    }

    function stringToColor(str) {
        let hash = 0;
        for (let i = 0; i < str.length; i++) {
            hash = str.charCodeAt(i) + ((hash << 5) - hash);
        }
        const c = (hash & 0x00FFFFFF).toString(16).toUpperCase();
        return "#" + "00000".substring(0, 6 - c.length) + c;
    }

    document.getElementById('send-comment-btn').onclick = () => {
        const input = document.getElementById('new-comment-input');
        const text = input.value;
        if (!text) return;

        const iframe = document.querySelector('#player iframe');
        if (!iframe) return;
        const videoId = iframe.src.split('/').pop().split('?')[0];
        const storageKey = 'comments_' + videoId;
        const userComments = JSON.parse(localStorage.getItem(storageKey) || '[]');

        userComments.push({
            user: 'Playtube User',
            text: text,
            time: 'Baru saja'
        });

        localStorage.setItem(storageKey, JSON.stringify(userComments));
        input.value = '';
        renderComments(videoId);
        showToast('Komentar ditambahkan');
    };

    document.getElementById('new-comment-input').onkeypress = (e) => {
        if (e.key === 'Enter') document.getElementById('send-comment-btn').click();
    };

    function toggleAction(el, type) {
        el.classList.toggle('active');
        if (el.classList.contains('active')) {
            // CSS handles the color change via .active class
            showToast(type === 'liked' ? 'Anda menyukai video ini' : 'Anda tidak menyukai video ini');
        } else {
            // CSS handles return to default
        }
    }

    function shareVideo(videoId) {
        const url = 'https://playtube.com/v/' + videoId;
        navigator.clipboard.writeText(url).then(() => {
            showToast('Link disalin ke clipboard');
        });
    }

    function toggleSubscribe(btn, channelName) {
        let subs = JSON.parse(localStorage.getItem('playtube_subscriptions') || '[]');
        const isSubbed = subs.includes(channelName);

        if (isSubbed) {
            subs = subs.filter(c => c !== channelName);
            showToast('Berhenti subscribe ' + channelName);
        } else {
            subs.push(channelName);
            showToast('Disubscribe: ' + channelName);
        }

        localStorage.setItem('playtube_subscriptions', JSON.stringify(subs));
        updateSubscribeButton(btn, channelName);
    }

    function updateSubscribeButton(btn, channelName) {
        const subs = JSON.parse(localStorage.getItem('playtube_subscriptions') || '[]');
        const isSubbed = subs.includes(channelName);

        if (isSubbed) {
            btn.textContent = 'Disubscribe';
            btn.style.backgroundColor = 'var(--hover-bg)';
            btn.style.color = 'var(--text-secondary)';
        } else {
            btn.textContent = 'Subscribe';
            btn.style.backgroundColor = 'white';
            btn.style.color = 'black';
        }
    }

    // Initial load
    checkLogin();
    if (localStorage.getItem('playtube_logged_in')) {
        loadTrending();
    }
</script>

</body>
</html>
